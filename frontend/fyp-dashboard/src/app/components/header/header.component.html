<mat-toolbar class="header" *ngIf="showLayout">
  <button mat-icon-button (click)="onToggleSidebar()" class="icon">
    <mat-icon>menu</mat-icon>
  </button>
  <span>Web Insight</span>

  <mat-form-field class="website-selector">
    <mat-label>Select</mat-label>
    <mat-select [(value)]="selectedWebsite" placeholder="Select a site">
      <mat-option *ngFor="let site of websites" [value]="site.website_id">
        {{ site.name }}
      </mat-option>
    </mat-select>
  </mat-form-field>

  <button mat-icon-button [matMenuTriggerFor]="menu" class="icon">
    <mat-icon>calendar_today</mat-icon>
  </button>
  <mat-menu #menu="matMenu">
    <mat-form-field class="date-menu">
      <mat-label>Select a date range</mat-label>
      <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
        <input matStartDate formControlName="start" placeholder="Start date" />
        <input matEndDate formControlName="end" placeholder="End date" />
      </mat-date-range-input>
      <mat-hint>DD/MM/YYYY – DD/MM/YYYY</mat-hint>
      <mat-datepicker-toggle
        matIconSuffix
        [for]="picker"
      ></mat-datepicker-toggle>
      <mat-date-range-picker #picker></mat-date-range-picker>
      <mat-error *ngIf="range.get('start')?.hasError('matStartDateInvalid')">
        Invalid start date
      </mat-error>
      <mat-error *ngIf="range.get('end')?.hasError('matEndDateInvalid')">
        Invalid end date
      </mat-error>
    </mat-form-field>
  </mat-menu>

  <p *ngIf="range.value.start && range.value.end" class="selected-dates">
    Selected dates: {{ range.value.start | date : "dd/MM/yyyy" }}
    –
    {{ range.value.end | date : "dd/MM/yyyy" }}
  </p>

  <span class="header-spacer"></span>

  <button mat-icon-button [matMenuTriggerFor]="userMenu" class="icon">
    <mat-icon>account_circle</mat-icon>
  </button>

  <mat-menu
    #userMenu="matMenu"
    class="user-menu"
    xPosition="before"
    yPosition="below"
  >
    <div class="user-info">
      <p class="user-name">{{ userName }}</p>
      <p class="user-email">{{ userEmail }}</p>
    </div>

    <mat-divider></mat-divider>

    <button mat-menu-item (click)="logout()" class="logout-btn">
      <mat-icon>logout</mat-icon>
      <span>Logout</span>
    </button>
  </mat-menu>
</mat-toolbar>